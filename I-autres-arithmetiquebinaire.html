<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>BinarySuite - Ultimate</title>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Fira+Code:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üå©Ô∏è</text></svg>">

    <style>
        /* --- THEME CYBER (GLOBAL VARIABLES) --- */
        :root {
            --bg-color: #050505;
            --grid-color: rgba(0, 243, 255, 0.05);
            --card-bg: rgba(16, 20, 25, 0.9);
            --border-color: #30363d;
            
            /* Palette N√©on */
            --neon-blue: #00f3ff;
            --neon-purple: #a855f7;
            --neon-green: #00ff41;
            --neon-red: #ff0055;
            --neon-yellow: #facc15;
            
            --text-main: #e0e0e0;
            --text-muted: #8b949e;
            
            --font-main: 'Share Tech Mono', monospace;
            --font-code: 'Fira Code', monospace;
        }

        /* --- RESET & BODY --- */
        * { box-sizing: border-box; }
        body { 
            margin: 0; padding: 0; overflow-x: hidden;
            font-family: var(--font-main);
            background-color: var(--bg-color);
            color: var(--text-main);
            /* Fond Grille Informatique */
            background-image: 
                linear-gradient(var(--grid-color) 1px, transparent 1px),
                linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
            background-size: 40px 40px;
        }

        /* --- BOUTON SWITCH MODE --- */
        #mode-switcher {
            position: fixed; top: 10px; right: 10px; z-index: 900;
            background: rgba(0, 0, 0, 0.8); 
            color: var(--neon-blue);
            border: 1px solid var(--neon-blue);
            padding: 8px 15px; border-radius: 4px; /* Coins plus carr√©s */
            font-family: var(--font-main); font-size: 12px; letter-spacing: 1px;
            cursor: pointer; box-shadow: 0 0 10px rgba(0, 243, 255, 0.1); 
            transition: all 0.2s; text-transform: uppercase;
        }
        #mode-switcher:hover { 
            background: var(--neon-blue); color: #000; box-shadow: 0 0 20px var(--neon-blue);
        }

        /* ============================================================
           STYLES CALCULATRICE (THEME DARK CYBER)
           ============================================================ */
        #calc-trigger-btn {
            position: fixed; bottom: 80px; right: 20px;
            width: 60px; height: 60px; border-radius: 50%;
            background: #000; color: var(--neon-yellow); 
            border: 2px solid var(--neon-yellow);
            box-shadow: 0 0 15px rgba(250, 204, 21, 0.3);
            z-index: 2000; cursor: pointer; display: flex; align-items: center; justify-content: center;
            font-size: 24px; transition: transform 0.2s;
        }
        #calc-trigger-btn:hover { transform: scale(1.1); background: var(--neon-yellow); color: black; }
        
        #global-calc-panel {
            position: fixed; top: 0; right: -100%;
            width: 100%; height: 100vh;
            background: #0d1117; z-index: 2001; /* Fond sombre */
            border-left: 1px solid var(--border-color);
            box-shadow: -5px 0 25px rgba(0,0,0,0.5);
            transition: right 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex; flex-direction: column; font-family: var(--font-code);
        }
        #global-calc-panel.open { right: 0; }

        .nw-header {
            background: #161b22; color: var(--neon-yellow); padding: 10px 15px;
            display: flex; justify-content: space-between; align-items: center;
            font-weight: bold; border-bottom: 1px solid var(--border-color);
        }
        .nw-close { background: none; border: none; color: var(--text-main); font-size: 1.2rem; cursor: pointer; }
        .nw-close:hover { color: var(--neon-red); }

        .nw-screen {
            flex-grow: 1; background: #000; padding: 15px;
            overflow-y: auto; display: flex; flex-direction: column; gap: 10px;
            color: var(--text-main);
        }
        .nw-item {
            display: flex; flex-direction: column; align-items: flex-end;
            padding: 8px 0; border-bottom: 1px dashed #333; animation: fadeIn 0.2s;
        }
        .nw-expr { font-size: 0.9rem; color: #888; margin-bottom: 2px; }
        .nw-res { font-size: 1.4rem; font-weight: bold; color: var(--neon-blue); } /* R√©sultat en bleu n√©on */

        .nw-current-line {
            margin-top: auto; text-align: right; min-height: 40px;
            font-size: 1.5rem; color: #fff; padding-top: 10px;
            border-top: 2px solid var(--neon-yellow);
        }
        .cursor { display: inline-block; width: 2px; height: 1.2rem; background: var(--neon-yellow); animation: blink 1s infinite; vertical-align: middle; }
        @keyframes blink { 50% { opacity: 0; } }

        .nw-keyboard {
            background: #161b22; padding: 10px; padding-bottom: max(20px, env(safe-area-inset-bottom));
            display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px;
            border-top: 1px solid #333;
        }
        .nw-key {
            background: #21262d; border: 1px solid #30363d; border-radius: 4px;
            height: 50px; font-size: 1.1rem; font-family: var(--font-main); font-weight: 600;
            color: #c9d1d9; cursor: pointer; 
            transition: all 0.1s;
            display: flex; align-items: center; justify-content: center;
            user-select: none;
        }
        .nw-key:active { transform: translateY(2px); border-color: var(--neon-blue); }
        
        .k-dark { background: #0d1117; color: var(--neon-purple); border-color: #30363d; }
        .k-gray { background: #30363d; color: #fff; }
        .k-yellow { 
            background: rgba(250, 204, 21, 0.1); color: var(--neon-yellow); 
            border-color: var(--neon-yellow); 
        }
        .k-yellow:hover { background: var(--neon-yellow); color: #000; }
        
        @media (min-width: 768px) {
            #calc-trigger-btn { bottom: 30px; right: 30px; }
            #global-calc-panel { width: 360px; }
        }

        /* ============================================================
           STYLES TABLEAU BIT-PAR-BIT (Theme Terminal)
           ============================================================ */
        .binary-grid-container {
            background: #0d1117; border: 1px solid var(--neon-blue); border-radius: 4px;
            padding: 20px; margin: 20px auto; max-width: 600px; font-family: var(--font-code);
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.05);
        }
        .bit-grid {
            display: grid; grid-template-columns: 40px repeat(8, 1fr); gap: 8px;
            align-items: center; margin-bottom: 20px;
        }
        .bit-cell {
            background: #21262d; color: #8b949e; padding: 10px 0; text-align: center;
            border-radius: 2px; font-weight: bold; font-size: 1.1rem; border: 1px solid #30363d;
        }
        .bit-input {
            width: 100%; padding: 10px 0; text-align: center;
            border: 1px solid #30363d; border-radius: 2px;
            font-family: var(--font-code); font-size: 1.2rem; font-weight: bold;
            color: var(--neon-blue); background: #000; transition: all 0.2s;
        }
        .bit-input:focus { border-color: var(--neon-blue); outline: none; box-shadow: 0 0 10px rgba(0, 243, 255, 0.2); }
        .row-label { font-weight: bold; color: var(--neon-purple); text-align: right; padding-right: 10px; }
        .grid-divider { grid-column: 1 / -1; height: 1px; background: #30363d; margin: 5px 0; }
        
        .vcn-container { display: flex; justify-content: center; gap: 20px; margin-top: 15px; padding-top: 15px; border-top: 1px dashed #30363d; }
        .vcn-box { display: flex; flex-direction: column; align-items: center; gap: 5px; }
        .vcn-label { font-weight: bold; font-size: 0.9rem; }
        .vcn-input { width: 50px; height: 50px; text-align: center; font-size: 1.2rem; border: 1px solid #30363d; border-radius: 4px; font-family: var(--font-code); background: #000; color: #fff; }
        .vcn-input:focus { border-color: var(--neon-yellow); outline: none; }
        
        .bit-header { font-size: 0.7rem; color: #484f58; text-align: center; margin-bottom: -5px; }

        /* LISTE D'ERREURS D√âTAILL√âE */
        .error-list { list-style: none; padding: 0; margin: 0; text-align: left; font-size: 0.9rem; }
        .error-list li { margin-bottom: 5px; padding-left: 20px; position: relative; color: var(--neon-red); }
        .error-list li::before { content: "‚úñ"; position: absolute; left: 0; font-weight: bold; }
        
        /* Mobile styles override */
        #mobile-view .binary-grid-container {
            overflow-x: auto; padding: 10px;
            background: #0d1117; border-color: var(--border-color);
        }
        #mobile-view .bit-grid { min-width: 320px; }
        #mobile-view .bit-cell { background: #161b22; color: #8b949e; }
        #mobile-view .bit-input { background: #000; color: var(--neon-blue); border-color: #30363d; }
        #mobile-view .row-label { color: var(--neon-purple); }

        @media (max-width: 480px) {
            .bit-grid { gap: 4px; }
            .bit-cell, .bit-input { font-size: 0.9rem; padding: 5px 0; }
            .binary-grid-container { padding: 10px; }
        }

        /* ============================================================
           STYLES ORIGINAUX ADAPT√âS CYBER (Mobile & Desktop Views)
           ============================================================ */
        #mobile-view {
            --m-bg: #050505; --m-card: rgba(22, 27, 34, 0.95); --m-text: #e0e0e0;
            --m-accent: #00f3ff; --m-code: #0d1117; --m-success: #00ff41; --m-error: #ff0055;
            font-family: var(--font-main);
            background-color: transparent; /* H√©rite du body */
            color: var(--m-text);
            padding-bottom: 95px; min-height: 100vh; display: block;
        }
        #mobile-view .ios-header { 
            position: sticky; top: 0; background: rgba(5, 5, 5, 0.95); backdrop-filter: blur(10px); 
            border-bottom: 1px solid var(--neon-blue); padding: 15px; 
            display: flex; align-items: center; justify-content: space-between;
            z-index: 1000; 
        }
        #mobile-view .back-btn { 
            color: var(--m-accent); text-decoration: none; font-size: 17px; display: flex; align-items: center; gap:5px; 
            text-transform: uppercase; letter-spacing: 1px;
        }
        #mobile-view .tab-content { display: none; padding: 20px; animation: fadeIn 0.3s ease; }
        #mobile-view .tab-content.active { display: block; }
        
        #mobile-view .ios-card { 
            background: var(--m-card); border-radius: 4px; padding: 16px; margin-bottom: 20px; 
            border: 1px solid rgba(255,255,255,0.1); border-left: 3px solid var(--neon-purple);
        }
        #mobile-view h2 { color: var(--m-accent); font-size: 1.3rem; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 1px;}
        #mobile-view p { color: var(--text-muted); line-height: 1.5; font-size: 0.95rem; }
        
        #mobile-view .bit-box { 
            font-family: var(--font-code); background: var(--m-code); padding: 10px; border-radius: 4px; 
            text-align: center; font-size: 1.5rem; letter-spacing: 2px; margin: 15px 0; 
            color: var(--neon-green); border: 1px solid #30363d;
        }
        #mobile-view input { 
            background: #000; border: 1px solid #30363d; border-radius: 4px; color: white; 
            padding: 12px; width: 100%; font-family: var(--font-code); margin-bottom: 10px; 
            text-align: center; font-size: 1.2rem; 
        }
        #mobile-view input:focus { border-color: var(--m-accent); outline: none; }
        
        #mobile-view button.ios-btn { 
            background: transparent; color: var(--m-accent); border: 1px solid var(--m-accent); 
            border-radius: 4px; padding: 12px; width: 100%; font-weight: 600; margin-top: 10px; 
            cursor: pointer; text-transform: uppercase; letter-spacing: 1px; transition: 0.2s;
        }
        #mobile-view button.ios-btn:hover { background: var(--m-accent); color: #000; box-shadow: 0 0 15px var(--m-accent); }
        
        #mobile-view .feedback { margin-top: 15px; padding: 12px; border-radius: 4px; display: none; text-align: center; }
        #mobile-view .feedback.success { background: rgba(0, 255, 65, 0.1); color: var(--m-success); border: 1px solid var(--m-success); }
        #mobile-view .feedback.error { background: rgba(255, 0, 85, 0.1); color: var(--m-error); border: 1px solid var(--m-error); }
        
        #mobile-view .tab-bar { 
            position: fixed; bottom: 0; left: 0; right: 0; 
            background: rgba(5, 5, 5, 0.95); backdrop-filter: blur(10px); 
            border-top: 1px solid var(--border-color); display: flex; justify-content: space-around; 
            padding-bottom: env(safe-area-inset-bottom); z-index: 1000; 
        }
        #mobile-view .tab-item { flex: 1; padding: 10px 0; text-align: center; color: #555; background: none; border: none; font-size: 10px; cursor: pointer; }
        #mobile-view .tab-item.active { color: var(--m-accent); text-shadow: 0 0 5px var(--m-accent); }
        #mobile-view .tab-icon { font-size: 20px; display: block; margin-bottom: 4px; }

        /* DESKTOP */
        #desktop-view {
            --d-primary: #00f3ff; /* Neon Blue */
            --d-primary-dark: #0099cc; 
            --d-secondary: #8b949e;
            --d-accent: #a855f7; /* Neon Purple */
            --d-bg-body: #050505; 
            --d-bg-card: rgba(22, 27, 34, 0.8);
            --d-text-main: #e0e0e0; 
            --d-text-light: #8b949e; 
            --d-success: #00ff41;
            --d-danger: #ff0055; 
            --d-warning: #facc15; 
            --d-warning-bg: rgba(250, 204, 21, 0.1);
            --d-sidebar-width: 280px; --d-radius: 4px;
            
            font-family: var(--font-main); background-color: transparent; color: var(--d-text-main);
            display: none; min-height: 100vh;
        }
        #desktop-view .sidebar { 
            width: var(--d-sidebar-width); background: #0d1117; color: white; 
            position: fixed; height: 100vh; left: 0; top: 0; padding: 20px; 
            display: flex; flex-direction: column; z-index: 100; transition: transform 0.3s ease; 
            overflow-y: auto; border-right: 1px solid var(--border-color);
        }
        #desktop-view .brand { 
            font-size: 1.4rem; font-weight: 700; margin-bottom: 30px; display: flex; align-items: center; gap: 10px; 
            color: var(--d-primary); border-bottom: 1px solid var(--border-color); padding-bottom: 20px; 
            text-transform: uppercase; letter-spacing: 2px; text-shadow: 0 0 10px rgba(0, 243, 255, 0.3);
        }
        #desktop-view .nav-category { font-size: 0.75rem; text-transform: uppercase; letter-spacing: 1px; color: #484f58; margin: 20px 0 10px 10px; font-weight: 700; }
        #desktop-view .nav-links { list-style: none; flex-grow: 1; padding: 0; }
        #desktop-view .nav-item { margin-bottom: 5px; }
        #desktop-view .nav-btn { 
            width: 100%; text-align: left; padding: 10px 15px; background: transparent; border: 1px solid transparent; 
            color: #8b949e; cursor: pointer; border-radius: 4px; font-size: 0.9rem; font-weight: 500; 
            transition: all 0.2s; display: flex; align-items: center; gap: 12px; font-family: var(--font-main);
        }
        #desktop-view .nav-btn:hover { background: rgba(255,255,255,0.05); color: white; border-color: #30363d; }
        #desktop-view .nav-btn.active { 
            background: rgba(0, 243, 255, 0.1); color: var(--d-primary); 
            border-color: var(--d-primary); box-shadow: 0 0 10px rgba(0, 243, 255, 0.1); 
        }
        #desktop-view .main-content { margin-left: var(--d-sidebar-width); flex-grow: 1; padding: 40px; width: calc(100% - var(--d-sidebar-width)); }
        #desktop-view .section { display: none; animation: fadeIn 0.4s ease; max-width: 1000px; margin: 0 auto; }
        #desktop-view .section.active { display: block; }
        #desktop-view h1 { font-size: 2rem; margin-bottom: 10px; color: var(--d-primary); text-transform: uppercase; letter-spacing: 2px;}
        #desktop-view h2 { font-size: 1.5rem; margin: 30px 0 20px; color: var(--d-accent); text-transform: uppercase;}
        #desktop-view h3 { font-size: 1.2rem; margin: 20px 0 10px; color: var(--d-text-main); font-weight: 600; text-transform: uppercase;}
        #desktop-view p { line-height: 1.7; color: var(--d-text-light); margin-bottom: 15px; }
        
        #desktop-view .card { 
            background: var(--d-bg-card); border-radius: var(--d-radius); padding: 25px; 
            margin-bottom: 25px; border: 1px solid var(--border-color); 
        }
        #desktop-view .card-expert { border-left: 3px solid var(--d-accent); }
        #desktop-view .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        
        #desktop-view .concept-box { 
            background: rgba(0, 243, 255, 0.05); border-left: 3px solid var(--d-primary); 
            padding: 20px; border-radius: 0 var(--d-radius) var(--d-radius) 0; margin: 20px 0; 
        }
        #desktop-view .binary-code { 
            font-family: var(--font-code); background: #000; color: var(--d-primary); 
            padding: 2px 6px; border-radius: 2px; font-size: 0.9em; border: 1px solid #30363d;
        }
        
        #desktop-view input[type="number"], #desktop-view input[type="text"] { 
            width: 100%; padding: 12px; border: 1px solid #30363d; border-radius: 4px; 
            font-family: var(--font-code); font-size: 1rem; transition: border-color 0.2s; 
            margin-bottom: 10px; background: #000; color: white;
        }
        #desktop-view input:focus { outline: none; border-color: var(--d-primary); box-shadow: 0 0 10px rgba(0, 243, 255, 0.2); }
        
        #desktop-view .btn { 
            padding: 12px 24px; border: 1px solid transparent; border-radius: 4px; font-weight: 600; cursor: pointer; 
            transition: all 0.2s; display: inline-flex; align-items: center; justify-content: center; 
            gap: 8px; font-size: 0.95rem; font-family: var(--font-main); text-transform: uppercase; letter-spacing: 1px;
        }
        #desktop-view .btn-primary { background: transparent; color: var(--d-primary); border-color: var(--d-primary); }
        #desktop-view .btn-primary:hover { background: var(--d-primary); color: #000; box-shadow: 0 0 15px var(--d-primary); }
        
        #desktop-view .btn-accent { background: transparent; color: var(--d-accent); border-color: var(--d-accent); }
        #desktop-view .btn-accent:hover { background: var(--d-accent); color: #000; box-shadow: 0 0 15px var(--d-accent); }

        #desktop-view .btn-success { background: transparent; color: var(--d-success); border-color: var(--d-success); }
        #desktop-view .btn-success:hover { background: var(--d-success); color: #000; box-shadow: 0 0 15px var(--d-success); }
        
        #desktop-view .btn-outline { background: transparent; border: 1px solid #30363d; color: var(--d-secondary); }
        #desktop-view .btn-outline:hover { border-color: var(--d-primary); color: var(--d-primary); }
        #desktop-view .btn-text { background: transparent; color: var(--d-secondary); text-decoration: underline; font-size: 0.9rem; border: none;}
        
        #desktop-view .training-card, #desktop-view .exercise-box { 
            text-align: center; padding: 40px; background: rgba(22, 27, 34, 0.8); 
            border-radius: 4px; border: 1px solid var(--border-color); 
        }
        #desktop-view .problem-display, #desktop-view .bit-display { 
            font-size: 2.5rem; font-weight: 700; color: var(--d-primary); margin: 20px 0; font-family: var(--font-code); 
            text-shadow: 0 0 10px rgba(0, 243, 255, 0.3);
        }
        
        #desktop-view #ac_feedback { margin-top: 20px; padding: 15px; border-radius: 4px; text-align: left; display: none; background: #000; border: 1px solid #333; }
        #desktop-view .feedback-correct { background-color: rgba(0, 255, 65, 0.1) !important; color: var(--d-success); border-color: var(--d-success) !important; padding: 10px; }
        #desktop-view .feedback-wrong { background-color: rgba(255, 0, 85, 0.1) !important; color: var(--d-danger); border-color: var(--d-danger) !important; padding: 10px; }
        
        #desktop-view .explanation-step { margin-top: 15px; padding-left: 15px; border-left: 3px solid #333; font-family: var(--font-main); font-size: 0.95rem; line-height: 1.6; }
        
        #desktop-view .expert-tabs { display: flex; background: #000; padding: 5px; border-radius: 4px; margin-bottom: 20px; border: 1px solid #30363d; }
        #desktop-view .expert-tab { flex: 1; text-align: center; padding: 10px; cursor: pointer; border-radius: 2px; font-weight: 600; color: #555; }
        #desktop-view .expert-tab.active { background: #21262d; color: var(--d-accent); border: 1px solid var(--d-accent); }
        #desktop-view .expert-sub-section { display: none; }
        #desktop-view .expert-sub-section.active { display: block; animation: fadeIn 0.3s; }
        #desktop-view .mobile-toggle { display: none; position: fixed; top: 15px; right: 15px; z-index: 200; background: #000; color: var(--d-primary); padding: 10px; border-radius: 4px; border: 1px solid var(--d-primary); }
        
        @media (max-width: 768px) {
            #desktop-view .sidebar { transform: translateX(-100%); width: 280px; }
            #desktop-view .sidebar.open { transform: translateX(0); box-shadow: 10px 0 30px rgba(0,0,0,0.5); }
            #desktop-view .main-content { margin-left: 0; width: 100%; padding: 20px; padding-top: 70px; }
            #desktop-view .mobile-toggle { display: block; }
            #desktop-view .grid-2 { grid-template-columns: 1fr; }
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <button id="mode-switcher" onclick="toggleMode()">üíª Passer en mode Ordi</button>

    <button id="calc-trigger-btn" onclick="toggleGlobalCalc()" title="Ouvrir la calculatrice">
        <i class="fas fa-calculator"></i>
    </button>

    <div id="global-calc-panel">
        <div class="nw-header">
            <span>NumWorks_CYBER</span>
            <button class="nw-close" onclick="toggleGlobalCalc()"><i class="fas fa-times"></i></button>
        </div>
        
        <div class="nw-screen" id="nw-screen">
            <div style="text-align:center; color:#444; margin-top:50px; font-family:var(--font-main);" id="nw-placeholder">
                // SYSTEM_READY
            </div>
            <div class="nw-current-line">
                <span id="nw-input"></span><span class="cursor"></span>
            </div>
        </div>

        <div class="nw-keyboard">
            <button class="nw-key k-dark" onclick="nwKey('(')">(</button>
            <button class="nw-key k-dark" onclick="nwKey(')')">)</button>
            <button class="nw-key k-dark" onclick="nwKey('**')">^</button>
            <button class="nw-key k-dark" onclick="nwClear()" style="border-color:var(--neon-red); color:var(--neon-red);">AC</button>
            
            <button class="nw-key" onclick="nwKey('7')">7</button>
            <button class="nw-key" onclick="nwKey('8')">8</button>
            <button class="nw-key" onclick="nwKey('9')">9</button>
            <button class="nw-key k-gray" onclick="nwKey('/')">√∑</button>
            
            <button class="nw-key" onclick="nwKey('4')">4</button>
            <button class="nw-key" onclick="nwKey('5')">5</button>
            <button class="nw-key" onclick="nwKey('6')">6</button>
            <button class="nw-key k-gray" onclick="nwKey('*')">√ó</button>
            
            <button class="nw-key" onclick="nwKey('1')">1</button>
            <button class="nw-key" onclick="nwKey('2')">2</button>
            <button class="nw-key" onclick="nwKey('3')">3</button>
            <button class="nw-key k-gray" onclick="nwKey('-')">-</button>
            
            <button class="nw-key" onclick="nwKey('0')">0</button>
            <button class="nw-key" onclick="nwKey('.')">.</button>
            <button class="nw-key k-dark" onclick="nwBack()"><i class="fas fa-backspace"></i></button>
            <button class="nw-key k-gray" onclick="nwKey('+')">+</button>

            <button class="nw-key k-yellow" style="grid-column: span 4; font-weight:800;" onclick="nwCalc()">EXE</button>
        </div>
    </div>


    <div id="mobile-view">
        <header class="ios-header">
            <a href="I-Autres.html" class="back-btn">
                <i class="fas fa-chevron-left"></i> Retour
            </a>
            <div style="font-weight:600; font-size:1.1rem; text-transform:uppercase; letter-spacing:1px; color:white;">Binaire_Mobile</div>
            <button onclick="toggleMode()" style="background:none; border:none; color:var(--neon-blue); font-size:1.2rem; cursor:pointer;" title="Mode Ordinateur">
                <i class="fas fa-desktop"></i>
            </button>
        </header>

        <div id="m-tab-cours" class="tab-content active">
            <div class="ios-card">
                <h2>Le Binaire (Base 2)</h2>
                <p>Les ordinateurs n'utilisent que <strong>0</strong> et <strong>1</strong>.</p>
                <div class="bit-box">1010 = 10</div>
                <p><strong>Poids :</strong> 128 | 64 | 32 | 16 | 8 | 4 | 2 | 1</p>
            </div>
            <div class="ios-card">
                <h2>Le Signe (C2)</h2>
                <p>Pour les n√©gatifs, on utilise le <strong>Compl√©ment √† 2</strong>.</p>
                <ol style="margin-left:20px; color:var(--text-muted);">
                    <li>Inverser les bits (0‚Üí1, 1‚Üí0)</li>
                    <li>Ajouter 1 au r√©sultat</li>
                </ol>
            </div>
        </div>

        <div id="m-tab-train" class="tab-content">
            <div class="ios-card">
                <h2>D√©cimal ‚Üí Binaire</h2>
                <p>Convertissez ce nombre (8 bits) :</p>
                <div class="bit-box" id="m-quest-val">...</div>
                <input type="text" id="m-input-val" placeholder="Ex: 00101010">
                <button class="ios-btn" onclick="checkMobileTraining()">V√©rifier</button>
                <div id="m-feedback" class="feedback"></div>
                <button class="ios-btn" style="border-color:#333; color:#aaa; margin-top:10px;" onclick="initMobileTraining()">Suivant</button>
            </div>
        </div>
        
        <div id="m-tab-tools" class="tab-content">
            <div class="ios-card">
                <h2>Convertisseur</h2>
                <p>D√©cimal vers Binaire (Non sign√©)</p>
                <input type="number" id="m-tool-input" placeholder="Nombre (ex: 42)">
                <button class="ios-btn" onclick="mobileConvert()">Convertir</button>
                <div class="bit-box" id="m-tool-res" style="margin-top:20px; font-size:1.2rem;">...</div>
            </div>
        </div>

        <div id="m-tab-expert" class="tab-content">
            <div class="ios-card" style="border-left: 3px solid var(--neon-yellow);">
                <h2>CPU 8-bits & Flags</h2>
                <p style="font-size:0.8rem;">Remplissez bit par bit. Faites d√©filer horizontalement si n√©cessaire.</p>
                
                <div class="binary-grid-container">
                    <div class="bit-grid">
                        <div></div>
                        <div class="bit-header">7</div><div class="bit-header">6</div><div class="bit-header">5</div><div class="bit-header">4</div>
                        <div class="bit-header">3</div><div class="bit-header">2</div><div class="bit-header">1</div><div class="bit-header">0</div>

                        <div class="row-label">A</div>
                        <div id="m-a-7" class="bit-cell">0</div><div id="m-a-6" class="bit-cell">0</div><div id="m-a-5" class="bit-cell">0</div><div id="m-a-4" class="bit-cell">0</div>
                        <div id="m-a-3" class="bit-cell">0</div><div id="m-a-2" class="bit-cell">0</div><div id="m-a-1" class="bit-cell">0</div><div id="m-a-0" class="bit-cell">0</div>

                        <div class="row-label">+ B</div>
                        <div id="m-b-7" class="bit-cell">0</div><div id="m-b-6" class="bit-cell">0</div><div id="m-b-5" class="bit-cell">0</div><div id="m-b-4" class="bit-cell">0</div>
                        <div id="m-b-3" class="bit-cell">0</div><div id="m-b-2" class="bit-cell">0</div><div id="m-b-1" class="bit-cell">0</div><div id="m-b-0" class="bit-cell">0</div>

                        <div class="grid-divider"></div>

                        <div class="row-label">=</div>
                        <input type="text" id="m-res-7" class="bit-input" maxlength="1" oninput="focusNext(this, 'm-res-6')">
                        <input type="text" id="m-res-6" class="bit-input" maxlength="1" oninput="focusNext(this, 'm-res-5')">
                        <input type="text" id="m-res-5" class="bit-input" maxlength="1" oninput="focusNext(this, 'm-res-4')">
                        <input type="text" id="m-res-4" class="bit-input" maxlength="1" oninput="focusNext(this, 'm-res-3')">
                        <input type="text" id="m-res-3" class="bit-input" maxlength="1" oninput="focusNext(this, 'm-res-2')">
                        <input type="text" id="m-res-2" class="bit-input" maxlength="1" oninput="focusNext(this, 'm-res-1')">
                        <input type="text" id="m-res-1" class="bit-input" maxlength="1" oninput="focusNext(this, 'm-res-0')">
                        <input type="text" id="m-res-0" class="bit-input" maxlength="1" oninput="focusNext(this, 'm-val-v')">
                    </div>

                    <div class="vcn-container">
                        <div class="vcn-box">
                            <span class="vcn-label" style="color:var(--neon-yellow);">V</span>
                            <input type="text" id="m-val-v" class="vcn-input" maxlength="1" placeholder="?" oninput="focusNext(this, 'm-val-c')">
                        </div>
                        <div class="vcn-box">
                            <span class="vcn-label" style="color:var(--neon-blue);">C</span>
                            <input type="text" id="m-val-c" class="vcn-input" maxlength="1" placeholder="?" oninput="focusNext(this, 'm-val-n')">
                        </div>
                        <div class="vcn-box">
                            <span class="vcn-label" style="color:var(--neon-red);">N</span>
                            <input type="text" id="m-val-n" class="vcn-input" maxlength="1" placeholder="?">
                        </div>
                    </div>
                </div>

                <button class="ios-btn" onclick="checkMobileExpertGrid()">V√©rifier</button>
                <div id="m-ac-feedback" class="feedback"></div>
                <button class="ios-btn" style="border-color:#333; color:#aaa; margin-top:10px;" onclick="initMobileExpertGrid()">Question Suivante</button>
            </div>
        </div>

        <nav class="tab-bar">
            <button class="tab-item active" onclick="switchMobileTab('m-tab-cours', this)">
                <span class="tab-icon"><i class="fas fa-book"></i></span> Cours
            </button>
            <button class="tab-item" onclick="switchMobileTab('m-tab-train', this)">
                <span class="tab-icon"><i class="fas fa-gamepad"></i></span> Jeu
            </button>
            <button class="tab-item" onclick="switchMobileTab('m-tab-tools', this)">
                <span class="tab-icon"><i class="fas fa-exchange-alt"></i></span> Outils
            </button>
            <button class="tab-item" onclick="switchMobileTab('m-tab-expert', this); initMobileExpertGrid();">
                <span class="tab-icon"><i class="fas fa-microchip"></i></span> CPU
            </button>
        </nav>
    </div>


    <div id="desktop-view">
        <button class="mobile-toggle" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>

        <nav class="sidebar" id="sidebar">
            <div class="brand">
                <i class="fas fa-layer-group"></i>&nbsp; BinarySuite
            </div>
            <a href="I-Autres.html" class="nav-btn" style="color: var(--neon-blue); margin-bottom: 20px;">
                <i class="fas fa-arrow-left"></i> Retour Menu
            </a>
            
            <div class="nav-category">üéì Parcours D√©couverte</div>
            <ul class="nav-links">
                <li class="nav-item">
                    <button class="nav-btn active" onclick="showSection('intro', this)">
                        <i class="fas fa-book-open"></i> Introduction
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-btn" onclick="showSection('formats', this)">
                        <i class="fas fa-microchip"></i> Formats & Signes
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-btn" onclick="showSection('operations', this)">
                        <i class="fas fa-calculator"></i> Op√©rations (+/-)
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-btn" onclick="showSection('training', this)" style="color: var(--neon-green);">
                        <i class="fas fa-gamepad"></i> Entra√Ænement Ludique
                    </button>
                </li>
            </ul>

            <div class="nav-category">üõ†Ô∏è Outils Avanc√©s</div>
            <ul class="nav-links">
                <li class="nav-item">
                    <button class="nav-btn" onclick="showSection('academic', this)" style="color: var(--neon-purple);">
                        <i class="fas fa-university"></i> Mode Expert (Bit-√†-Bit)
                    </button>
                </li>
                <li class="nav-item">
                    <button class="nav-btn" onclick="showSection('converter', this)">
                        <i class="fas fa-exchange-alt"></i> Convertisseur Rapide
                    </button>
                </li>
            </ul>
        </nav>

        <main class="main-content">
            <div id="intro" class="section active">
                <h1>Arithm√©tique Binaire</h1>
                <p class="lead">Comprendre comment les ordinateurs comptent et calculent.</p>
                <div class="card">
                    <h2>Pourquoi le binaire ?</h2>
                    <p>En √©lectronique num√©rique, un transistor n'a que deux √©tats stables : <strong>bloqu√©</strong> (pas de courant) ou <strong>satur√©</strong> (courant passe). C'est pour cela que l'informatique utilise la base 2.</p>
                    <div class="concept-box"><i class="fas fa-lightbulb" style="color: var(--neon-yellow);"></i> <strong>Analogie :</strong> Imaginez une rang√©e d'interrupteurs. Chaque interrupteur est un <strong>bit</strong>.</div>
                </div>
                <div class="grid-2">
                    <div class="card">
                        <h3>Unit√©s de mesure</h3>
                        <ul>
                            <li><strong>Bit (b)</strong> : 0 ou 1</li>
                            <li><strong>Nibble</strong> : 4 bits (ex: <span class="binary-code">1010</span>)</li>
                            <li><strong>Octet (Byte/B)</strong> : 8 bits</li>
                            <li><strong>Mot (Word)</strong> : 16, 32 ou 64 bits</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h3>Puissances de 2</h3>
                        <p>√Ä conna√Ætre par c≈ìur pour convertir rapidement :</p>
                        <div style="display: flex; gap: 5px; flex-wrap: wrap;">
                            <span class="binary-code">2‚Å∞=1</span><span class="binary-code">2¬π=2</span><span class="binary-code">2¬≤=4</span>
                            <span class="binary-code">2¬≥=8</span><span class="binary-code">2‚Å¥=16</span><span class="binary-code">2‚Åµ=32</span>
                            <span class="binary-code">2‚Å∂=64</span><span class="binary-code">2‚Å∑=128</span>
                        </div>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="triggerNav('formats')">Suivant : Formats & Signes <i class="fas fa-arrow-right"></i></button>
            </div>

            <div id="formats" class="section">
                <h1>Formats & Nombres Sign√©s</h1>
                <div class="card">
                    <h2>Entiers Naturels (Non sign√©s)</h2>
                    <p>Avec <strong>n</strong> bits, on peut coder de <strong>0</strong> √† <strong>2‚Åø - 1</strong>.</p>
                    <table><tr><th>Bits</th><th>Plage</th><th>Exemple (Max)</th></tr><tr><td>4 bits</td><td>0 √† 15</td><td><span class="binary-code">1111</span> = 15</td></tr><tr><td>8 bits</td><td>0 √† 255</td><td><span class="binary-code">11111111</span> = 255</td></tr></table>
                </div>
                <div class="card">
                    <h2>Entiers Relatifs (Sign√©s)</h2>
                    <p>Pour repr√©senter des nombres n√©gatifs, on utilise la m√©thode du <strong>Compl√©ment √† 2 (C2)</strong>.</p>
                    <div class="concept-box">
                        <h3>Recette pour trouver -X (ex: -5 sur 8 bits) :</h3>
                        <ol style="margin-left: 20px;">
                            <li>√âcrire X en binaire : <span class="binary-code">0000 0101</span> (5)</li>
                            <li>Inverser les bits (C1) : <span class="binary-code">1111 1010</span></li>
                            <li>Ajouter 1 : <span class="binary-code">1111 1011</span> (-5)</li>
                        </ol>
                    </div>
                    <p><strong>Note :</strong> Le bit le plus √† gauche (MSB) indique le signe (0 = positif, 1 = n√©gatif).</p>
                </div>
                <button class="btn btn-primary" onclick="triggerNav('operations')">Suivant : Op√©rations <i class="fas fa-arrow-right"></i></button>
            </div>

            <div id="operations" class="section">
                <h1>Op√©rations Binaires</h1>
                <div class="grid-2">
                    <div class="card">
                        <h3>‚ûï L'Addition</h3>
                        <p>Les r√®gles de base :</p>
                        <ul style="list-style: none;"><li>0 + 0 = 0</li><li>0 + 1 = 1</li><li>1 + 0 = 1</li><li>1 + 1 = 0 (je retiens 1)</li><li>1 + 1 + 1 = 1 (je retiens 1)</li></ul>
                    </div>
                    <div class="card">
                        <h3>‚ûñ La Soustraction</h3>
                        <p>En binaire, on ne soustrait pas. On additionne l'oppos√©.</p>
                        <p><strong>A - B</strong> devient <strong>A + (-B)</strong></p>
                        <p>Il faut donc convertir B en son compl√©ment √† 2 avant d'additionner.</p>
                    </div>
                </div>
                <div class="card">
                    <h3>Exemple : 6 - 3 (sur 4 bits)</h3>
                    <div class="binary-code" style="padding: 15px; display: block;">
                        6  = 0110<br>-3 = 1101 (compl√©ment √† 2 de 0011)<br>-----------<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0110<br>&nbsp;&nbsp;+ 1101<br>&nbsp;&nbsp;------<br>&nbsp;¬π10011 -> On garde 4 bits : <strong>0011</strong> (3)
                    </div>
                </div>
                <button class="btn btn-primary" onclick="triggerNav('training')">Aller s'entra√Æner <i class="fas fa-dumbbell"></i></button>
            </div>

            <div id="training" class="section">
                <h1 style="color: var(--d-success);">üî• Entra√Ænement Ludique</h1>
                <p>Mode "Infinite Training" : G√©n√©rez des exercices al√©atoires. L'aide appara√Ætra apr√®s 3 erreurs.</p>
                <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                    <button class="btn btn-outline" onclick="setTrainingMode('dec2bin')">D√©cimal ‚Üí Binaire</button>
                    <button class="btn btn-outline" onclick="setTrainingMode('bin2dec')">Binaire ‚Üí D√©cimal</button>
                    <button class="btn btn-outline" onclick="setTrainingMode('addition')">Addition</button>
                    <button class="btn btn-outline" onclick="setTrainingMode('subtraction')">Soustraction (C2)</button>
                </div>
                <div class="training-card">
                    <h3 id="train_title">S√©lectionnez un mode ci-dessus</h3>
                    <div id="train_content" style="display:none;">
                        <div class="problem-display" id="train_question">---</div>
                        <div style="max-width: 400px; margin: 0 auto;">
                            <input type="text" id="train_answer" placeholder="Votre r√©ponse..." style="text-align: center;">
                            <div style="display: flex; gap: 10px; margin-top: 10px;">
                                <button class="btn btn-primary" style="flex: 2;" onclick="checkAnswer()">V√©rifier</button>
                                <button class="btn btn-outline" style="flex: 1;" onclick="showCorrection()">Voir correction</button>
                            </div>
                            <button class="btn btn-text" onclick="generateQuestion()" style="margin-top: 15px;">Passer / Nouvelle question</button>
                        </div>
                        <div id="train_hint" class="hint-box" style="margin-top: 15px; padding: 15px; background: var(--d-warning-bg); border: 1px solid var(--d-warning); border-radius: 4px; display:none; color: var(--d-warning);">
                            <i class="fas fa-life-ring"></i> <strong>Indice :</strong> <span id="hint_text"></span>
                        </div>
                        <div id="train_feedback" style="margin-top: 15px; padding: 15px; border-radius: 4px; display:none;"></div>
                    </div>
                </div>
            </div>

            <div id="academic" class="section">
                <h1 style="color: var(--d-accent);">üèõÔ∏è Mode Expert / Acad√©mique</h1>
                <p>Ce mode simule le fonctionnement interne d'un processeur 8 bits, incluant la gestion des erreurs via les drapeaux (Flags).</p>
                <div class="expert-tabs">
                    <div class="expert-tab active" onclick="ac_switchTab('ac-cours')">1. Rappels Th√©oriques (Flags)</div>
                    <div class="expert-tab" onclick="ac_switchTab('ac-training')">2. Exercice Complet (VCN)</div>
                </div>
                <div id="ac-cours" class="expert-sub-section active">
                    <div class="card card-expert"><h3>I. Formats et Entiers Naturels</h3><p>Un format de <b>n</b> bits permet de coder $2^n$ valeurs. Exemple sur 8 bits : de 0 √† 255.</p></div>
                    <div class="card card-expert"><h3>II. Entiers Relatifs & Compl√©ment √† 2</h3><p>Le bit de poids fort indique le signe : <b>0 = Positif, 1 = N√©gatif</b>.</p></div>
                    <div class="card card-expert">
                        <h3>III. Indicateurs d'√âtat (Flags)</h3>
                        <p>Le CPU l√®ve des drapeaux apr√®s un calcul :</p>
                        <ul><li><b>N (Negative)</b> : 1 si le r√©sultat est n√©gatif (bit de poids fort √† 1).</li><li><b>C (Carry/Retenue)</b> : 1 s'il y a une retenue sortante (d√©passement capacit√© unsigned).</li><li><b>V (Overflow/D√©bordement)</b> : 1 si le r√©sultat sign√© est incoh√©rent (ex: Positif + Positif = N√©gatif).</li></ul>
                    </div>
                    <button class="btn btn-accent" onclick="ac_switchTab('ac-training')">Passer aux exercices</button>
                </div>
                
                <div id="ac-training" class="expert-sub-section">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <p style="font-size: 0.9em; color: var(--text-muted);">Remplissez le r√©sultat et les drapeaux (0 ou 1) case par case.</p>
                    </div>

                    <div class="exercise-box">
                        <h2 id="ac-ex-title">Calculatrice CPU (8 bits)</h2>
                        
                        <div class="binary-grid-container">
                            <div class="bit-grid" id="bit-grid-display">
                                <div></div>
                                <div class="bit-header">7</div><div class="bit-header">6</div><div class="bit-header">5</div><div class="bit-header">4</div>
                                <div class="bit-header">3</div><div class="bit-header">2</div><div class="bit-header">1</div><div class="bit-header">0</div>

                                <div class="row-label">A</div>
                                <div id="a-7" class="bit-cell">0</div><div id="a-6" class="bit-cell">0</div><div id="a-5" class="bit-cell">0</div><div id="a-4" class="bit-cell">0</div>
                                <div id="a-3" class="bit-cell">0</div><div id="a-2" class="bit-cell">0</div><div id="a-1" class="bit-cell">0</div><div id="a-0" class="bit-cell">0</div>

                                <div class="row-label">+ B</div>
                                <div id="b-7" class="bit-cell">0</div><div id="b-6" class="bit-cell">0</div><div id="b-5" class="bit-cell">0</div><div id="b-4" class="bit-cell">0</div>
                                <div id="b-3" class="bit-cell">0</div><div id="b-2" class="bit-cell">0</div><div id="b-1" class="bit-cell">0</div><div id="b-0" class="bit-cell">0</div>

                                <div class="grid-divider"></div>

                                <div class="row-label">=</div>
                                <input type="text" id="res-7" class="bit-input" maxlength="1" oninput="focusNext(this, 'res-6')">
                                <input type="text" id="res-6" class="bit-input" maxlength="1" oninput="focusNext(this, 'res-5')">
                                <input type="text" id="res-5" class="bit-input" maxlength="1" oninput="focusNext(this, 'res-4')">
                                <input type="text" id="res-4" class="bit-input" maxlength="1" oninput="focusNext(this, 'res-3')">
                                <input type="text" id="res-3" class="bit-input" maxlength="1" oninput="focusNext(this, 'res-2')">
                                <input type="text" id="res-2" class="bit-input" maxlength="1" oninput="focusNext(this, 'res-1')">
                                <input type="text" id="res-1" class="bit-input" maxlength="1" oninput="focusNext(this, 'res-0')">
                                <input type="text" id="res-0" class="bit-input" maxlength="1" oninput="focusNext(this, 'val-v')">
                            </div>

                            <div class="vcn-container">
                                <div class="vcn-box">
                                    <span class="vcn-label" style="color:var(--neon-yellow);">V (Overflow)</span>
                                    <input type="text" id="val-v" class="vcn-input" maxlength="1" placeholder="?" oninput="focusNext(this, 'val-c')">
                                </div>
                                <div class="vcn-box">
                                    <span class="vcn-label" style="color:var(--neon-blue);">C (Carry)</span>
                                    <input type="text" id="val-c" class="vcn-input" maxlength="1" placeholder="?" oninput="focusNext(this, 'val-n')">
                                </div>
                                <div class="vcn-box">
                                    <span class="vcn-label" style="color:var(--neon-red);">N (Negative)</span>
                                    <input type="text" id="val-n" class="vcn-input" maxlength="1" placeholder="?">
                                </div>
                            </div>
                        </div>

                        <div style="text-align: center;">
                            <button class="btn btn-success" onclick="ac_checkAnswer()">V√©rifier (Bit √† Bit)</button>
                            <button class="btn btn-primary" onclick="ac_generateExercise()">Question Suivante</button>
                        </div>
                        
                        <div id="ac_feedback"></div>
                    </div>
                </div>
            </div>

            <div id="converter" class="section">
                <h1>Outils de Conversion</h1>
                <div class="grid-2">
                    <div class="card">
                        <h3>D√©cimal vers Binaire</h3>
                        <input type="number" id="conv_dec_input" placeholder="Entrez un entier (ex: 42)">
                        <div style="margin: 10px 0;"><label><input type="checkbox" id="conv_signed"> Mode sign√© (8 bits)</label></div>
                        <button class="btn btn-primary" onclick="toolConvertDec()">Convertir</button>
                        <div id="conv_dec_res" style="margin-top: 15px; font-weight: bold; color:var(--d-success);"></div>
                    </div>
                    <div class="card">
                        <h3>Binaire vers D√©cimal</h3>
                        <input type="text" id="conv_bin_input" placeholder="Entrez des 0 et 1 (ex: 101010)">
                        <div style="margin: 10px 0;"><label><input type="checkbox" id="conv_bin_signed"> Interpr√©ter comme sign√© (C2)</label></div>
                        <button class="btn btn-primary" onclick="toolConvertBin()">Convertir</button>
                        <div id="conv_bin_res" style="margin-top: 15px; font-weight: bold; color:var(--d-success);"></div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // --- LOGIQUE NAVIGATION ---
        function toggleSidebar() { document.getElementById('sidebar').classList.toggle('open'); }
        function showSection(id, btnElement) {
            document.querySelectorAll('#desktop-view .section').forEach(el => el.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            if(btnElement) {
                document.querySelectorAll('#desktop-view .nav-btn').forEach(el => el.classList.remove('active'));
                btnElement.classList.add('active');
            }
            if(window.innerWidth < 768) { document.getElementById('sidebar').classList.remove('open'); }
        }
        function triggerNav(targetId) {
            const btn = Array.from(document.querySelectorAll('#desktop-view .nav-btn')).find(b => b.getAttribute('onclick').includes(targetId));
            showSection(targetId, btn);
            window.scrollTo(0,0);
        }

        // --- SWITCH MODE ---
        let isMobile = true;
        function toggleMode() {
            isMobile = !isMobile;
            const m = document.getElementById('mobile-view');
            const d = document.getElementById('desktop-view');
            const btn = document.getElementById('mode-switcher');
            const b = document.body;

            if (isMobile) {
                m.style.display = 'block'; d.style.display = 'none';
                btn.innerText = "üíª Passer en mode Ordi";
            } else {
                m.style.display = 'none'; d.style.display = 'block';
                btn.innerText = "üì± Passer en mode Mobile";
            }
        }

        // --- MOBILE JS ---
        function switchMobileTab(tabId, btn) {
            document.querySelectorAll('#mobile-view .tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('#mobile-view .tab-item').forEach(el => el.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            btn.classList.add('active');
            window.scrollTo(0,0);
        }
        let mTarget = 0;
        function initMobileTraining() {
            mTarget = Math.floor(Math.random() * 255);
            document.getElementById('m-quest-val').innerText = mTarget;
            document.getElementById('m-input-val').value = "";
            document.getElementById('m-feedback').style.display = "none";
        }
        function checkMobileTraining() {
            const u = document.getElementById('m-input-val').value;
            const fb = document.getElementById('m-feedback');
            const ans = mTarget.toString(2);
            fb.style.display="block";
            if (parseInt(u, 2) === mTarget) {
                fb.innerText="‚úÖ Correct !"; fb.className="feedback success";
            } else {
                fb.innerText=`‚ùå Faux. C'√©tait ${ans}`; fb.className="feedback error";
            }
        }
        function mobileConvert() {
            const v = document.getElementById('m-tool-input').value;
            document.getElementById('m-tool-res').innerText = parseInt(v).toString(2);
        }
        initMobileTraining();


        // ============================================================
        //  LOGIQUE CALCULATRICE NUMWORKS
        // ============================================================
        let nwInput = "";
        function toggleGlobalCalc() {
            document.getElementById('global-calc-panel').classList.toggle('open');
            if(document.getElementById('global-calc-panel').classList.contains('open')) {
                document.addEventListener('keydown', nwHandleKeyboard);
            } else {
                document.removeEventListener('keydown', nwHandleKeyboard);
            }
        }
        function updateNwDisplay() { document.getElementById('nw-input').innerText = nwInput; }
        function nwKey(val) { document.getElementById('nw-placeholder').style.display = 'none'; nwInput += val; updateNwDisplay(); }
        function nwClear() { nwInput = ""; updateNwDisplay(); }
        function nwBack() { nwInput = nwInput.slice(0, -1); updateNwDisplay(); }
        function nwCalc() {
            if(!nwInput) return;
            let result = "";
            try {
                let expr = nwInput.replace(/\^/g, '**');
                if(/[^0-9+\-*/().\s]/.test(expr)) throw new Error("Erreur");
                result = eval(expr); 
                if(!isFinite(result) || isNaN(result)) throw new Error("Erreur");
                if(result.toString().length > 10) result = result.toPrecision(8);
            } catch(e) { result = "Erreur"; }
            const screen = document.getElementById('nw-screen');
            const item = document.createElement('div');
            item.className = 'nw-item';
            item.innerHTML = `<div class="nw-expr">${nwInput}</div><div class="nw-res">${result}</div>`;
            const currentLine = document.querySelector('.nw-current-line');
            screen.insertBefore(item, currentLine);
            screen.scrollTop = screen.scrollHeight;
            nwInput = ""; updateNwDisplay();
        }
        function nwHandleKeyboard(e) {
            const key = e.key;
            if(key >= '0' && key <= '9') nwKey(key);
            else if(['+', '-', '*', '/', '.', '(', ')'].includes(key)) nwKey(key);
            else if(key === 'Enter') nwCalc();
            else if(key === 'Backspace') nwBack();
            else if(key === 'Escape') nwClear();
            else if(key === '^') nwKey('**');
        }


        // ============================================================
        //  LOGIQUE MODE EXPERT (DESKTOP) AVEC EXPLICATIONS
        // ============================================================
        
        let ac_currentProblem = {};

        function focusNext(el, nextId) {
            if(el.value.length === 1) {
                if(!/[01]/.test(el.value)) { el.value = ''; return; }
                const next = document.getElementById(nextId);
                if(next) next.focus();
            }
        }

        function ac_switchTab(tabId) {
            document.querySelectorAll('.expert-sub-section').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.expert-tab').forEach(el => el.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            const tabs = { 'ac-cours': 0, 'ac-training': 1 };
            if(tabs[tabId] !== undefined) { document.querySelectorAll('.expert-tab')[tabs[tabId]].classList.add('active'); }
            if(tabId === 'ac-training' && !ac_currentProblem.binRep) { ac_generateExercise(); }
        }

        function ac_toBinary(num, bits) {
            let val = num;
            if (val < 0) val = (1 << bits) + val; 
            let bin = val.toString(2);
            while (bin.length < bits) bin = "0" + bin;
            return bin;
        }

        function ac_generateExercise() {
            document.getElementById('ac_feedback').style.display = 'none';
            for(let i=0; i<8; i++) document.getElementById('res-'+i).value = '';
            document.getElementById('val-v').value = ''; document.getElementById('val-c').value = ''; document.getElementById('val-n').value = '';
            
            let numA = Math.floor(Math.random() * 256); if(numA > 127) numA -= 256; 
            let numB = Math.floor(Math.random() * 256); if(numB > 127) numB -= 256;

            let binA = ac_toBinary(numA, 8); let binB = ac_toBinary(numB, 8);
            for(let i=0; i<8; i++) {
                document.getElementById('a-'+i).innerText = binA.charAt(7-i);
                document.getElementById('b-'+i).innerText = binB.charAt(7-i);
            }

            let sumFull = numA + numB;
            let arr = new Int8Array(1); arr[0] = sumFull;
            let resultSigned8 = arr[0];
            let resultBin = ac_toBinary(resultSigned8, 8);

            let flagN = (resultSigned8 < 0) ? '1' : '0';
            let flagV = '0';
            if (numA >= 0 && numB >= 0 && resultSigned8 < 0) flagV = '1';
            if (numA < 0 && numB < 0 && resultSigned8 >= 0) flagV = '1';
            let usA = (numA < 0) ? numA + 256 : numA;
            let usB = (numB < 0) ? numB + 256 : numB;
            let flagC = ((usA + usB) > 255) ? '1' : '0';

            ac_currentProblem = { binRep: resultBin, V: flagV, C: flagC, N: flagN, decRep: resultSigned8 };
        }

        function ac_checkAnswer() {
            let feedback = document.getElementById('ac_feedback'); feedback.style.display = 'block';
            let errors = [];
            let errorDetails = [];

            // V√©rification des Bits
            let bitErrors = [];
            for(let i=7; i>=0; i--) {
                let cell = document.getElementById('res-'+i);
                let val = cell.value;
                if(val !== ac_currentProblem.binRep.charAt(7-i)) { 
                    cell.style.backgroundColor = "rgba(255, 0, 85, 0.2)"; cell.style.color = "#ff0055"; 
                    errors.push(`Bit ${i}`);
                    bitErrors.push(i);
                } else { 
                    cell.style.backgroundColor = "rgba(0, 255, 65, 0.2)"; cell.style.color = "#00ff41"; 
                }
            }
            if(bitErrors.length > 0) errorDetails.push(`Erreur de calcul sur les bits : ${bitErrors.join(', ')}.`);

            let vIn = document.getElementById('val-v'); let cIn = document.getElementById('val-c'); let nIn = document.getElementById('val-n');
            
            // Check V
            if(vIn.value !== ac_currentProblem.V) { 
                vIn.style.backgroundColor = "rgba(255, 0, 85, 0.2)"; errors.push("Flag V"); 
                let reason = (ac_currentProblem.V === '1') ? "D√©passement sign√© (Signes incoh√©rents)." : "Pas de d√©passement sign√©.";
                errorDetails.push(`Erreur V : ${reason}`);
            } else vIn.style.backgroundColor = "rgba(0, 255, 65, 0.2)";

            // Check C
            if(cIn.value !== ac_currentProblem.C) { 
                cIn.style.backgroundColor = "rgba(255, 0, 85, 0.2)"; errors.push("Flag C"); 
                let reason = (ac_currentProblem.C === '1') ? "Retenue sortante (unsigned overflow)." : "Pas de retenue sortante.";
                errorDetails.push(`Erreur C : ${reason}`);
            } else cIn.style.backgroundColor = "rgba(0, 255, 65, 0.2)";

            // Check N
            if(nIn.value !== ac_currentProblem.N) { 
                nIn.style.backgroundColor = "rgba(255, 0, 85, 0.2)"; errors.push("Flag N"); 
                errorDetails.push("Erreur N : Doit √™tre identique au Bit 7 (Bit de signe).");
            } else nIn.style.backgroundColor = "rgba(0, 255, 65, 0.2)";


            if (errors.length === 0) { 
                feedback.className = 'feedback-correct'; 
                feedback.innerHTML = `<strong><i class="fas fa-check"></i> Excellent !</strong><br>Le r√©sultat ${ac_currentProblem.decRep} et tous les drapeaux sont corrects.`; 
            } else { 
                feedback.className = 'feedback-wrong'; 
                let html = `<strong><i class="fas fa-times"></i> Oups !</strong><br><ul class="error-list">`;
                errorDetails.forEach(e => html += `<li>${e}</li>`);
                html += `</ul>`;
                feedback.innerHTML = html;
            }
        }


        // ============================================================
        //  LOGIQUE MOBILE EXPERT (AVEC EXPLICATIONS)
        // ============================================================
        let m_ac_solution_grid = {};

        function initMobileExpertGrid() {
            document.getElementById('m-ac-feedback').style.display = 'none';
            for(let i=0; i<8; i++) {
                let el = document.getElementById('m-res-'+i);
                el.value = ''; el.style.backgroundColor = '#000'; el.style.color = '#00f3ff';
            }
            ['m-val-v', 'm-val-c', 'm-val-n'].forEach(id => {
                let el = document.getElementById(id);
                el.value = ''; el.style.backgroundColor = '#000';
            });
            
            let numA = Math.floor(Math.random() * 256); if(numA > 127) numA -= 256; 
            let numB = Math.floor(Math.random() * 256); if(numB > 127) numB -= 256;

            let binA = ac_toBinary(numA, 8); let binB = ac_toBinary(numB, 8);
            for(let i=0; i<8; i++) {
                document.getElementById('m-a-'+i).innerText = binA.charAt(7-i);
                document.getElementById('m-b-'+i).innerText = binB.charAt(7-i);
            }

            let sumFull = numA + numB;
            let arr = new Int8Array(1); arr[0] = sumFull;
            let resultSigned8 = arr[0];
            let resultBin = ac_toBinary(resultSigned8, 8);

            let flagN = (resultSigned8 < 0) ? '1' : '0';
            let flagV = '0';
            if (numA >= 0 && numB >= 0 && resultSigned8 < 0) flagV = '1';
            if (numA < 0 && numB < 0 && resultSigned8 >= 0) flagV = '1';
            let usA = (numA < 0) ? numA + 256 : numA;
            let usB = (numB < 0) ? numB + 256 : numB;
            let flagC = ((usA + usB) > 255) ? '1' : '0';

            m_ac_solution_grid = { binRep: resultBin, V: flagV, C: flagC, N: flagN };
        }

        function checkMobileExpertGrid() {
            let feedback = document.getElementById('m-ac-feedback'); feedback.style.display = 'block';
            let errors = [];
            let errorDetails = [];

            // Check Bits
            let bitErrors = [];
            for(let i=7; i>=0; i--) {
                let cell = document.getElementById('m-res-'+i);
                if(cell.value !== m_ac_solution_grid.binRep.charAt(7-i)) {
                    cell.style.backgroundColor = "rgba(255, 0, 85, 0.2)"; cell.style.color = "#ff0055"; 
                    errors.push(`Bit ${i}`);
                    bitErrors.push(i);
                } else {
                    cell.style.backgroundColor = "rgba(0, 255, 65, 0.2)"; cell.style.color = "#00ff41";
                }
            }
            if(bitErrors.length > 0) errorDetails.push(`Bits incorrects : ${bitErrors.join(', ')}.`);

            let vIn = document.getElementById('m-val-v'); let cIn = document.getElementById('m-val-c'); let nIn = document.getElementById('m-val-n');
            
            // Check V
            if(vIn.value !== m_ac_solution_grid.V) {
                vIn.style.backgroundColor = "rgba(255, 0, 85, 0.2)"; errors.push("V");
                let reason = (m_ac_solution_grid.V === '1') ? "D√©passement sign√© (Incoh√©rence)." : "Signes coh√©rents.";
                errorDetails.push(`Flag V : ${reason}`);
            } else vIn.style.backgroundColor = "rgba(0, 255, 65, 0.2)";

            // Check C
            if(cIn.value !== m_ac_solution_grid.C) {
                cIn.style.backgroundColor = "rgba(255, 0, 85, 0.2)"; errors.push("C");
                let reason = (m_ac_solution_grid.C === '1') ? "D√©bordement (Retenue sortante)." : "Pas de retenue.";
                errorDetails.push(`Flag C : ${reason}`);
            } else cIn.style.backgroundColor = "rgba(0, 255, 65, 0.2)";

            // Check N
            if(nIn.value !== m_ac_solution_grid.N) {
                nIn.style.backgroundColor = "rgba(255, 0, 85, 0.2)"; errors.push("N");
                errorDetails.push("Flag N : Doit copier le Bit 7.");
            } else nIn.style.backgroundColor = "rgba(0, 255, 65, 0.2)";

            if (errors.length === 0) {
                feedback.className = 'feedback success'; feedback.innerHTML = `<strong>‚úÖ Excellent !</strong><br>Tout est correct.`;
            } else {
                feedback.className = 'feedback error'; 
                let html = `<strong>‚ùå Erreurs :</strong><br><ul class="error-list">`;
                errorDetails.forEach(e => html += `<li>${e}</li>`);
                html += `</ul>`;
                feedback.innerHTML = html;
            }
        }


        // ============================================================
        //  FONCTIONS ORDI (CONVERSION / ENTRAINEMENT)
        // ============================================================
        function toolConvertDec() {
            let val = parseInt(document.getElementById('conv_dec_input').value);
            const isSigned = document.getElementById('conv_signed').checked;
            const resDiv = document.getElementById('conv_dec_res');
            if (isNaN(val)) { resDiv.innerHTML = "Entr√©e invalide"; return; }
            if (!isSigned) {
                if(val < 0) { resDiv.innerHTML = "Impossible en non-sign√©"; return; }
                resDiv.innerHTML = `R√©sultat : <span class="binary-code">${val.toString(2)}</span>`;
            } else {
                if(val < -128 || val > 127) { resDiv.innerHTML = "Hors limites (-128 √† +127)"; return; }
                let bin;
                if(val >= 0) bin = val.toString(2).padStart(8, '0');
                else bin = (val >>> 0).toString(2).slice(-8);
                resDiv.innerHTML = `R√©sultat (8 bits C2) : <span class="binary-code">${bin}</span>`;
            }
        }
        function toolConvertBin() {
            let val = document.getElementById('conv_bin_input').value.replace(/\s/g, '');
            const isSigned = document.getElementById('conv_bin_signed').checked;
            const resDiv = document.getElementById('conv_bin_res');
            if (!/^[01]+$/.test(val)) { resDiv.innerHTML = "Uniquement des 0 et 1"; return; }
            let dec = parseInt(val, 2);
            if (isSigned) {
                const bits = val.length;
                const maxVal = Math.pow(2, bits - 1);
                if (dec >= maxVal) { dec = dec - Math.pow(2, bits); }
            }
            resDiv.innerHTML = `R√©sultat : <strong>${dec}</strong>`;
        }
        
        let currentMode = ''; let currentSolution = ''; let errorCount = 0;
        function setTrainingMode(mode) {
            currentMode = mode; document.getElementById('train_content').style.display = 'block';
            const titles = {'dec2bin': 'D√©cimal ‚Üí Binaire', 'bin2dec': 'Binaire ‚Üí D√©cimal', 'addition': 'Addition Binaire', 'subtraction': 'Soustraction Binaire (C2)'};
            document.getElementById('train_title').innerText = titles[mode];
            document.querySelectorAll('#desktop-view #training .btn-outline').forEach(btn => {
                if(btn.onclick.toString().includes(mode)) { btn.classList.add('btn-primary'); btn.classList.remove('btn-outline'); }
                else { btn.classList.remove('btn-primary'); btn.classList.add('btn-outline'); }
            });
            generateQuestion();
        }
        function generateQuestion() {
            const feedback = document.getElementById('train_feedback');
            const hintBox = document.getElementById('train_hint');
            feedback.style.display = 'none'; feedback.innerHTML = ''; hintBox.style.display = 'none';
            document.getElementById('train_answer').value = ''; errorCount = 0;
            let qText = '';
            if (currentMode === 'dec2bin') {
                const num = Math.floor(Math.random() * 64);
                qText = `${num}‚ÇÅ‚ÇÄ = ?‚ÇÇ`; currentSolution = num.toString(2);
            } else if (currentMode === 'bin2dec') {
                const num = Math.floor(Math.random() * 64);
                qText = `${num.toString(2)}‚ÇÇ = ?‚ÇÅ‚ÇÄ`; currentSolution = num.toString();
            } else if (currentMode === 'addition') {
                const a = Math.floor(Math.random() * 32); const b = Math.floor(Math.random() * 32);
                qText = `${a.toString(2).padStart(6,'0')}<br>+ ${b.toString(2).padStart(6,'0')}`;
                currentSolution = (a+b).toString(2);
            } else if (currentMode === 'subtraction') {
                let a = Math.floor(Math.random() * 32) + 16; let b = Math.floor(Math.random() * 15);
                qText = `${a.toString(2).padStart(6,'0')}<br>- ${b.toString(2).padStart(6,'0')}`;
                currentSolution = (a-b).toString(2);
            }
            document.getElementById('train_question').innerHTML = qText;
        }
        function checkAnswer() {
            let userAns = document.getElementById('train_answer').value.replace(/\s/g, '').replace(/^0+/, '') || '0';
            let sol = currentSolution.replace(/^0+/, '') || '0';
            const feedback = document.getElementById('train_feedback'); feedback.style.display = 'block';
            if (userAns === sol) {
                feedback.innerHTML = `<strong><i class="fas fa-check-circle"></i> Bravo !</strong>`;
                feedback.style.background = 'rgba(0, 255, 65, 0.1)'; feedback.style.color = 'var(--d-success)';
                document.getElementById('train_hint').style.display = 'none'; setTimeout(generateQuestion, 2000);
            } else {
                errorCount++; feedback.style.background = 'rgba(255, 0, 85, 0.1)'; feedback.style.color = 'var(--d-danger)';
                feedback.innerHTML = `<strong><i class="fas fa-times-circle"></i> Incorrect.</strong>`;
                if (errorCount >= 3) showHint();
            }
        }
        function showHint() {
            document.getElementById('train_hint').style.display = 'block';
            let msg = "";
            if (currentMode === 'dec2bin') msg = "D√©composez en puissances de 2.";
            else if (currentMode === 'bin2dec') msg = "Additionnez les poids : 1, 2, 4, 8...";
            else if (currentMode === 'addition') msg = "1+1=0 retenue 1.";
            else if (currentMode === 'subtraction') msg = "Calculez l'oppos√© de B (inversion + 1) et additionnez.";
            document.getElementById('hint_text').innerText = msg;
        }
        function showCorrection() {
            const feedback = document.getElementById('train_feedback');
            feedback.style.display = 'block'; feedback.style.background = '#161b22'; feedback.style.color = 'var(--d-text-main)';
            feedback.innerHTML = `<strong>Correction :</strong> ${currentSolution}.`;
            document.getElementById('train_answer').value = currentSolution;
        }

        // Init
        if(window.innerWidth > 800) toggleMode();
    </script>
<style>
    /* L'√©cran noir qui recouvre tout au d√©but */
    #page-transition-overlay {
        position: fixed;
        top: 0; left: 0; width: 100%; height: 100%;
        background-color: #050505; /* Noir profond du th√®me */
        z-index: 99999; /* Au-dessus de tout */
        opacity: 1;
        transition: opacity 0.4s ease-in-out; /* Dur√©e de la transition */
        pointer-events: none; /* Permet de cliquer si jamais √ßa bug */
    }
    
    /* Classe ajout√©e en JS pour rendre transparent */
    #page-transition-overlay.hidden {
        opacity: 0;
    }
</style>

<div id="page-transition-overlay"></div>

<script>
    // 1. TRANSITION D'ENTR√âE (FADE IN)
    window.addEventListener('load', () => {
        const overlay = document.getElementById('page-transition-overlay');
        if(overlay) {
            // Petit d√©lai pour √™tre s√ªr que le navigateur a affich√© le fond noir
            setTimeout(() => {
                overlay.classList.add('hidden');
            }, 50);
        }
    });

    // 2. TRANSITION DE SORTIE (FADE OUT)
    document.querySelectorAll('a').forEach(link => {
        link.addEventListener('click', function(e) {
            const target = this.getAttribute('href');
            
            // On n'anime que les liens internes r√©els (pas les #, pas les liens externes)
            if (target && target !== '#' && !target.startsWith('javascript') && this.target !== '_blank') {
                e.preventDefault(); // Bloque le changement de page imm√©diat
                
                const overlay = document.getElementById('page-transition-overlay');
                if(overlay) {
                    overlay.classList.remove('hidden'); // Remet le noir
                    
                    // Attend la fin de l'animation (0.4s) avant de changer de page
                    setTimeout(() => {
                        window.location.href = target;
                    }, 400); 
                } else {
                    window.location.href = target; // S√©curit√© si l'overlay n'existe pas
                }
            }
        });
    });
</script>
</body>
</html>